# ============================================================================
# Microservices Project - Environment Configuration
# ============================================================================
# This file documents the environment variables and configuration used by
# the microservices project. Copy to .env if you need to override defaults.
# ============================================================================

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

# MySQL Database Host (for Docker: use service name)
MYSQL_HOST=localhost
MYSQL_PORT=3307
MYSQL_DATABASE=studentdb
MYSQL_ROOT_USER=root
MYSQL_ROOT_PASSWORD=root123

# Database Connection String (used by services)
# Format: jdbc:mysql://<host>:<port>/<database>?createDatabaseIfNotExist=true
DATABASE_URL=jdbc:mysql://localhost:3307/studentdb?createDatabaseIfNotExist=true

# ============================================================================
# SERVICE CONFIGURATION
# ============================================================================

# Eureka Server Configuration
EUREKA_SERVER_URL=http://localhost:8761/eureka
EUREKA_SERVER_PORT=8761

# Service Ports
GATEWAY_PORT=8080
DISCOVERY_PORT=8761
DEPARTMENT_SERVICE_PORT=8081
ENROLLMENT_SERVICE_PORT=8082
STUDENT_SERVICE_PORT=8083

# Service Hostnames
SERVICE_HOSTNAME=localhost
REGISTER_WITH_EUREKA=true
FETCH_REGISTRY=true
PREFER_IP_ADDRESS=true

# ============================================================================
# DOCKER CONFIGURATION
# ============================================================================

# Docker Container Names
MYSQL_CONTAINER_NAME=student-microservice-mysql
MYSQL_VOLUME_NAME=mysql_data
MYSQL_NETWORK_NAME=microservices-network

# Docker Image
MYSQL_IMAGE=mysql:8.0
MYSQL_CHARSET=utf8mb4

# ============================================================================
# APPLICATION CONFIGURATION
# ============================================================================

# Spring Boot Profile
SPRING_PROFILES_ACTIVE=default

# Logging Configuration
LOGGING_LEVEL_ROOT=INFO
LOGGING_LEVEL_ORG_SPRINGFRAMEWORK_WEB=DEBUG
LOGGING_LEVEL_ORG_HIBERNATE_SQL=DEBUG

# JPA/Hibernate Configuration
JPA_HIBERNATE_DDL_AUTO=update
JPA_SHOW_SQL=true
JPA_PROPERTIES_HIBERNATE_FORMAT_SQL=true

# Actuator Configuration
MANAGEMENT_ENDPOINTS_WEB_EXPOSURE_INCLUDE=*
MANAGEMENT_ENDPOINT_HEALTH_SHOW_DETAILS=always

# ============================================================================
# ENROLLMENT SERVICE - CQRS CONFIGURATION
# ============================================================================

# Axon Framework
AXON_AXONSERVER_ENABLED=false
AXON_CACHE_ENABLED=true
AXON_SERIALIZER_GENERAL=jackson

# Resilience4j Circuit Breaker
RESILIENCE4J_CIRCUITBREAKER_ENABLED=true
RESILIENCE4J_CIRCUITBREAKER_REGISTER_HEALTH_INDICATOR=true

# ============================================================================
# DEVELOPMENT CONFIGURATION
# ============================================================================

# Spring DevTools
SPRING_DEVTOOLS_RESTART_ENABLED=true
SPRING_DEVTOOLS_LIVERELOAD_ENABLED=true

# Debug Mode
DEBUG=false
TRACE=false

# ============================================================================
# SCRIPT CONFIGURATION
# ============================================================================

# Startup Script Timeouts (seconds)
EUREKA_STARTUP_TIMEOUT=30
SERVICE_STARTUP_TIMEOUT=25
MYSQL_STARTUP_TIMEOUT=30

# Skip Docker (set to true if MySQL already running externally)
SKIP_DOCKER=false

# ============================================================================
# NOTES
# ============================================================================
# 
# 1. Database Port (3307):
#    - External port for local development
#    - Internal Docker port: 3306
#    - This mapping allows MySQL access from host machine
#
# 2. Service Discovery:
#    - All services automatically register with Eureka
#    - Eureka server is the single source of truth
#    - Services can discover each other by name
#
# 3. Database Initialization:
#    - Hibernate automatically creates/updates tables
#    - Use ddl-auto=update for development
#    - Change to validate for production
#
# 4. Docker Networking:
#    - Services within Docker use the network name instead of localhost
#    - External access uses localhost:3307
#    - Docker Compose creates isolated network: microservices-network
#
# 5. Circuit Breaker:
#    - Enrollment service uses Resilience4j
#    - Protects against cascading failures
#    - Configure thresholds as needed
#
# ============================================================================
